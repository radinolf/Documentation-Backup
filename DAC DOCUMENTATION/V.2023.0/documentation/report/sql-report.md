# SQL Report

## Report Populated with Data from SQL Query

In DAC, reports can be defined on the basis of a SQL query. The reports created this way will continue to support most of the features of multi-dimensional analysis offered by the environment.

These reports will define the cubes and dimensions valid exclusively for the current report, which will be integrated with data from BI cubes.

This feature allows you to achieve the following improvements:

* _**Flexibility of mapping**_

A transactional environment, difficult to map through a structure of cubes and dimensions, can easily be analyzed.

* _**Speeding up mapping**_

You do not need to configure cubes-dimensions-metrics in order to read data from one or more tables, thus speeding up the process of mapping in the event of an impromptu analysis.

In the event data structures are mapped on which several reports have to be created, the more powerful and structured cube-dimension approach is preferred.

* _**Real-time access**_

Real-time access to a transactional database will be easier because the select query can be accurately defined.

* _**Accurate query definition**_

The ability to accurately define the report query will allow you, in the event the query generated by DAC is not optimized for the specific case, to redefine it in order to optimize it.

* _**Query customization for environment**_

The ability to accurately define the query will also allow you to write specific code for your environment.

* _**Multi-source reading**_

The SQL query, as for OLAP cubes, can be defined on JDBC data sources, Excel, CSV, XML.

* _**On-the-fly integration on the report**_

The SQL query can be integrated _on-the-fly_ within the report with the data in OLAP cubes, or other SQL queries.

For example, a report can be defined which accesses an OLAP cube, a query on DB2 query and a query on CSV files.

The system will allow you to configure 1 .. n SQL within a report, that will automatically be transformed into cubes only usable in the report where they are defined.

Both the cubes and the metrics created using the query will be distinguished from BI cubes and metrics by a different color, and the cube name coincides with that of the folder where the query is defined

![](<../../.gitbook/assets/53 (2).png>) ![](<../../.gitbook/assets/54 (1).png>)

In the section at the bottom of the _Editing_ _Report_ window , the section for defining the query is opened from the **SQL folder** macro:

* in the upper pane, you define the connection to the data source
* at the bottom you define [the select query](/broken/pages/-MfHyDAACqZ8KGz7lYEL#_QUERY_di_selezione)
* the commands on the right allow you to define the mapping of the cube'[s dimensions and metrics](/broken/pages/-MfHyDAACqZ8KGz7lYEL#_Mapping_Cubi_\(dimensioni)

![](<../../.gitbook/assets/55 (1).png>)

This methodology allows you to define:

* [Reports on SQL cubes](/broken/pages/-MfHyDAACqZ8KGz7lYEL#_Report_su_cubo)
* [Reports on multiple SQL cubes (Join)](/broken/pages/-MfHyDAACqZ8KGz7lYEL#_Report_costruito_su)
* [Report on SQL cubes and OLAP cubes](/broken/pages/-MfHyDAACqZ8KGz7lYEL#_Report_costruito_su_1)

### Datasource Connection

You can define the connection to the data source:

* On the same data source of the application (see _Application in DAC_ section)
* On a data source in the same Data Model environment
* On a remote data source, defined beforehand in the application (see _Remote data source connections_ section)

![](<../../.gitbook/assets/56 (9).png>)

### Select QUERY

In the lower pane, you insert the select query:

* manually, by using a content assist (next paragraph) for quickly selecting the data table
* using DAC’s “query editor”.

![](<../../.gitbook/assets/57 (4).png>)

The buttons at the top (to the left) support the insertion of the query:

![](<../../.gitbook/assets/58 (2).png>)

**Note:** _There must always be an AS clause with the corresponding alias for each field selected in the query._

#### Content Assist for Manually Formulating Queries

Content assist is available to help you to write queries:

* after entering the statement _SELECT \* FROM_ a menu opens with the **list of tables** of the selected data source.
* after choosing the table on the statement _SELECT \* FROM \[table]_ the item **Substitute** \* is enabled (right-click of the mouse) which replaces the columns of the table with the character "\*"; for each field the corresponding alias is inserted.
* after inserting the key word _group by_, the item **$AUTO\_GROUP\_BY$** is enabled. This will allow the system to automatically define which levels to group during the query execution phase.

![](<../../.gitbook/assets/59 (6).png>)

### Mapping Cubes (dimensions and metrics) of the QUERY

The default folders _Query 1, Query 2, Query_ 3 each contain data select queries; the data will then be _mapped_ to a new cube.

For each query, you define which fields are related to the metrics ([metrics mapping](/broken/pages/-MfHyDAACqZ8KGz7lYEL#_Metrics_Mapping)) [and which](/broken/pages/-MfHyDAACqZ8KGz7lYEL#_Mapping_metriche) ones relate to the levels ([levels mapping](/broken/pages/-MfHyDAACqZ8KGz7lYEL#_Mapping_livelli_dimensionali)).

![](<../../.gitbook/assets/60 (3).png>)

The new cube is created as soon as you select the OLAP folder:

* In the metrics and dimensions of the editing report window, the new cubes are visible (yellow color)
* By default, all query fields are mapped as levels
* The cube name coincides with that of the query folder

![](<../../.gitbook/assets/61 (6).png>)

You can change the name of the cube by renaming the query folder (right-click the item _Rename_).

![](<../../.gitbook/assets/62 (8).png>)

#### Metrics Mapping

You can define metrics mapping using the ![](<../../.gitbook/assets/63 (7).png>) button:

* a pop-up box opens with the list of selected fields in the SQL query.
* from these, you select those that relate to the measures.
* the system generates a first level metric for each measure chosen

![](<../../.gitbook/assets/64 (2).png>)

#### Mapping of Dimensional Levels (key-description relationship)

The mapping of levels is defined automatically: all fields that are not mapped as metrics are defined as levels.

If the table contains both the key and the description fields, you define their association in the pop-up box, opened by clicking the ![](<../../.gitbook/assets/65 (7).png>) button:

* all the fields selected in the query and NOT _mapped_ as metrics are listed on the left
* the same fields are shown on the right
* for the key fields on the left, select the respective description field on the right

![](<../../.gitbook/assets/66 (7).png>)

This setting allows you to have a report with the descriptive part displayed, while the key field is used for the JOIN.

###

### Reports on SQL Cubes

The simplest application of this feature is the mapping of a single QUERY cube and execution of a report populated by this data only.

The next example shows the necessary steps and the final result.

#### Example: Report Constructed on Data Extracted from SQL Query

Step 1: **Report Populated from QUERY Cube**

![SNAGHTML937592](../../.gitbook/assets/69.png)

_Creating a new report on a QUERY cube:_

* _Open the SQL folder and define the query in the Query1 panel._
* _The query selects the sales data_

Step 2: **Metrics Mapping**![](<../../.gitbook/assets/70 (7).png>)

_In the second step you map the metrics:_

* _Click the button to map metrics_
* _From the fields in the sales table you select those relating to the metrics (SALES\_QTY, SALES\_UNIT\_PRICE, SALES\_VAL)._

Step 3: **Creating and Running a QUERY Cube**

![](<../../.gitbook/assets/71 (7).png>)

_Select the OLAP folder and the system creates the QUERY cube just defined:_

* _under metrics, the new cube Query1 is shown, with the first-level metrics on fields mapped in the previous step_
* _the new cube Query1 is always shown under dimensions: the levels linked to the cube are those not defined as metrics._
* _Select a first level metric in the new cube and two levels; the report is run and the result shown in the figure is obtained_

### Reports on multiple SQL Cubes (Join)

A more complex application of the query feature is to define multiple cubes of this type.

In this case, you need to define the **join criteria** for relating the two cubes:

* The relationship between the two cubes is defined by assigning the same alias name to the join fields, in the two queries.

_We’ll use the sales table and the budget table, linked by the product, as an example._

_In defining both select queries, you must assign the same ALIAS NAME to the product field:_

| <p><em><strong>Query 1:</strong></em></p><p><em><strong>select</strong></em></p><p><em>ID_CUSTOMER</em> <em><strong>as</strong></em> <em>ID_CUSTOMER,</em></p><p> <em>ID_PRODUCT</em> <em><strong>as</strong></em> <em>ID_PRODUCT,</em></p><p><em>SALES_QTY</em> <em><strong>as</strong></em> <em>SALES_QTY,</em></p><p><em><strong>from</strong></em> <em>FT_SALES</em></p> | <p><em><strong>Query 2</strong>:</em></p><p><em><strong>select</strong></em></p><p><em>BDG_SALES_QTY</em> <em><strong>as</strong></em> <em>BDG_ _QTY,</em></p><p><em>BDG_SALES_VAL</em> <em><strong>as</strong></em> <em>BDG_VAL,</em></p><p> <em>ID_PRODUCT</em> <em><strong>as</strong></em> <em>ID_PRODUCT</em></p><p><em><strong>from</strong></em> <em>FT_BUDGET</em></p> |
| ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |

The next example details the definition of two QUERY cubes and the final result is presented

Step 1: Definition of the queries for the two cubes (same ALIAS on the JOIN fields)

![](../../.gitbook/assets/72.png)

_Two SQL queries are defined: for loading sales data and budget data:_

* _both queries have the same alias for the product field._

_You map the respective metrics on both queries, using the button shown in the figure. You rename the cubes SALES and BUDGET respectively._

Step 2: Creating QUERY cubes and reports in MULTICUBE ANALYSIS

![](<../../.gitbook/assets/73 (2).png>)

_Selecting the OLAP folder creates two SQL cubes: BUDGET and SALES, with the metrics and the levels set in the SQL section._

* _You select the levels and the newly created cube metrics for creating the report._

_If you access the Query viewer window (SLQ button shown in the figure), you’ll see the join performed by the report on the two cubes, in relation to the product column._

_By running the report you get the result shown in the figure (bottom)._

### Report on SQL Cubes and OLAP Cubes

The cubes that are created by using SQL queries can be related to those of BI: the cube just needs to have a column that can be related with a level of the BI cube.

Just **assign the logical name of the level as an alias of the** **column** to define the relationship between the QUERY cube and the BI cube.

The system facilitates the association of the name of the level with a _content_ _assist_ that proposes the logical names of the application levels: the default alias is deleted and the levels menu opens.

![](<../../.gitbook/assets/74 (5).png>)

Step 1: **Creating a QUERY Cube on Sales**

![](<../../.gitbook/assets/75 (3).png>)

_A report is created with a SQL cube of sales data and the BI Budget cube. These are linked by the product code, which is defined in the same way in the two fact tables._

_The select query is defined in the sales table. You delete the alias of the product and through the content assist you select the respective product level._

Step 2: Analysis eport on QUERY Cube and BI Cube

![](<../../.gitbook/assets/76 (3).png>)

_The report is created by using both the levels and metrics of the Sales QUERY cube, and the levels of the BI BUDGET cube._
