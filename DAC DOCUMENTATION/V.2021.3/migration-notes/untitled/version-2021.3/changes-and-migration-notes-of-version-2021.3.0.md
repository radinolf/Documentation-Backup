# Changes and migration notes of version 2021.3.0

## **Release Train** <a href="#release-train" id="release-train"></a>

Following are the artefacts of this release:

* **Decisyon App Composer for Docker** [decisyon-dac-docker-prod.jfrog.io/com.decisyon.appcomposer-docker:2021.3.0](http://decisyon-dac-docker-prod.jfrog.io/com.decisyon.appcomposer-docker:2021.3.0)
* **Decisyon App Composer for Kubernetes** [decisyon-dac-docker-prod.jfrog.io/com.decisyon.appcomposer-k8s:2021.3.0](http://decisyon-dac-docker-prod.jfrog.io/com.decisyon.appcomposer-k8s:2021.3.0)
* **Dumbella Job Executor** [decisyon-dac-docker-prod.jfrog.io/com.decisyon.dumbella:2021.3.0](http://decisyon-dac-docker-prod.jfrog.io/com.decisyon.dumbella:2021.3.0)
* **Cornelius Configuration Server** [decisyon-dac-docker-prod.jfrog.io/com.decisyon.cornelius:2021.3.0](http://decisyon-dac-docker-prod.jfrog.io/com.decisyon.cornelius:2021.3.0)
* **Keycloak OIDC Server** [decisyon-dac-docker-prod.jfrog.io/com.decisyon.keycloak:2021.3.0](http://decisyon-dac-docker-prod.jfrog.io/com.decisyon.keycloak:2021.3.0)
* **Gertrude Flowable Back-end** [decisyon-dac-docker-prod.jfrog.io/com.decisyon.gertrude:2021.3.0](http://decisyon-dac-docker-prod.jfrog.io/com.decisyon.gertrude:2021.3.0)
* **Flowable Modeler** [decisyon-dac-docker-prod.jfrog.io/com.decisyon.flowable-ui-modeler-app:2021.3.0](http://decisyon-dac-docker-prod.jfrog.io/com.decisyon.flowable-ui-modeler-app:2021.3.0)
* **Decisyon Design Studio** [Index of /public/dac-designstudio/release/2021.3.0/](http://repository.decisyon.com/public/dac-designstudio/release/2021.3.0)

**Configurable properties**<br>
-------------------------------

Following are the properties that need to be defined as environment variables to configure DAC properties:

| Property                                        | Description                                                                                                                                                                                                                                                                                                                                                           | Mandatory                                                                                                                                                                                                                 |
| ----------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **GENERAL SETTINGS**                            |                                                                                                                                                                                                                                                                                                                                                                       |                                                                                                                                                                                                                           |
| profiles.active                                 | Enables DAC features                                                                                                                                                                                                                                                                                                                                                  | YES: set its value to “prod”. You need to add “cornelius” if you want to use the configuration server or “monitoring” to enable metrics. For example spring.profiles.active=prod,cornelius,monitoring                     |
| appcomposer.discussions.fast-validation.enabled | Enables fast validation for Discussion                                                                                                                                                                                                                                                                                                                                | NO: defautl value is false                                                                                                                                                                                                |
| **HTTP SETTINGS**                               |                                                                                                                                                                                                                                                                                                                                                                       |                                                                                                                                                                                                                           |
| server.http2.enabled                            | Enables http2                                                                                                                                                                                                                                                                                                                                                         | NO: default value is false                                                                                                                                                                                                |
| **METADATA DATASOURC**                          |                                                                                                                                                                                                                                                                                                                                                                       |                                                                                                                                                                                                                           |
| service.metadata.name                           | Name of the metadata service                                                                                                                                                                                                                                                                                                                                          | YES: its value must be “metadata”                                                                                                                                                                                         |
| metadata.user                                   | Specify user to use to authenticate to the database                                                                                                                                                                                                                                                                                                                   | YES                                                                                                                                                                                                                       |
| metadata.password                               | Password                                                                                                                                                                                                                                                                                                                                                              | YES                                                                                                                                                                                                                       |
| metadata.database                               | Database name                                                                                                                                                                                                                                                                                                                                                         | YES                                                                                                                                                                                                                       |
| metadata.schema                                 | Specify name of the schema to use for Postgres                                                                                                                                                                                                                                                                                                                        | This value is mandatory only if use Postgres                                                                                                                                                                              |
| metadata.port                                   | Specify port of the database                                                                                                                                                                                                                                                                                                                                          | YES                                                                                                                                                                                                                       |
| metadata.host                                   | Specify hostname of the database                                                                                                                                                                                                                                                                                                                                      | YES                                                                                                                                                                                                                       |
| metadata.url                                    | Specify jdbc connection url of the database.                                                                                                                                                                                                                                                                                                                          | YES                                                                                                                                                                                                                       |
| metadata.minIdle                                |                                                                                                                                                                                                                                                                                                                                                                       | NO: default value is 5                                                                                                                                                                                                    |
| metadata.maxPoolSize                            | Maximum pool size                                                                                                                                                                                                                                                                                                                                                     | NO: default value is 100                                                                                                                                                                                                  |
| metadata.idleTimeout                            | Maximum idle time for connectio                                                                                                                                                                                                                                                                                                                                       | NO: default value is 300000default value i                                                                                                                                                                                |
| metadata.connectionTimeout                      | Maximum number of milliseconds that a client will wait for a connection                                                                                                                                                                                                                                                                                               | NO: default value is 600000                                                                                                                                                                                               |
| metadata.maxLifeTime                            | Maximum lifetime in milliseconds of a connection in the pool after it is closed                                                                                                                                                                                                                                                                                       | NO: default value is 600000                                                                                                                                                                                               |
| **SECURITY EXTENSIONS**                         |                                                                                                                                                                                                                                                                                                                                                                       |                                                                                                                                                                                                                           |
| appcomposer.keycloak.enabled                    | Enables the support for Keycloak                                                                                                                                                                                                                                                                                                                                      | NO: default value is false, set it true if use Keycloak.                                                                                                                                                                  |
| uaa.url                                         | User Management Endpoint                                                                                                                                                                                                                                                                                                                                              | This value is mandatory if you use Keycloak.                                                                                                                                                                              |
| appcomposer.azure.security.starter.enabled      | Enables support for Azure AD                                                                                                                                                                                                                                                                                                                                          | NO: default value is false, set it true if use Azure AD.                                                                                                                                                                  |
| appcomposer.schneider.security.starter.enabled  | Enables support for Schneider IDMS                                                                                                                                                                                                                                                                                                                                    | NO: default value is false, set it true if use Schenider IDMS                                                                                                                                                             |
| appcomposer.api-gateway.enabled                 | Enables support for Api Gateway                                                                                                                                                                                                                                                                                                                                       | NO: default value is false, set it true if use an Api Gateway                                                                                                                                                             |
| api-gateway.cookie.name                         |                                                                                                                                                                                                                                                                                                                                                                       | This value is mandatory if you use an Api Gateway.                                                                                                                                                                        |
| api-gateway.id-token.uid.claim                  |                                                                                                                                                                                                                                                                                                                                                                       | This value is mandatory if you use an Api Gateway.                                                                                                                                                                        |
| **SECURITY**                                    |                                                                                                                                                                                                                                                                                                                                                                       |                                                                                                                                                                                                                           |
| appcomposer.security.debug                      | Enables UI Toast to show any security alert due to param validation.                                                                                                                                                                                                                                                                                                  | NO: default is false                                                                                                                                                                                                      |
| appcomposer.security.service.token.seed         | Seed use to create a service token to enable secure communication with the other microservices.                                                                                                                                                                                                                                                                       | YES, in case you use any other DAC’s Microservices (e.g. Dumbella). It's must be a randomly generate 20-chars string.                                                                                                     |
| **WORKFLOW**                                    |                                                                                                                                                                                                                                                                                                                                                                       |                                                                                                                                                                                                                           |
| appcomposer.workflow.enabled                    | This is mandatory if you use the workflow                                                                                                                                                                                                                                                                                                                             | NO: default value is false, set it to true if use the workflow                                                                                                                                                            |
| flowable.task.url                               | Gertrude url                                                                                                                                                                                                                                                                                                                                                          | This is mandatory if you use the workflow                                                                                                                                                                                 |
| flowable.task.url                               | Flowable Modeler url                                                                                                                                                                                                                                                                                                                                                  | This is mandatory if you use the workflow                                                                                                                                                                                 |
| **DUMBELLA JOB EXECUTOR**                       |                                                                                                                                                                                                                                                                                                                                                                       |                                                                                                                                                                                                                           |
| appcomposer.dubella.enabled                     | Enables Dumbella                                                                                                                                                                                                                                                                                                                                                      | NO: default value is false, set it to true if use Dumbella                                                                                                                                                                |
| appcomposer.dubella.url                         | NO: default value is 50000                                                                                                                                                                                                                                                                                                                                            | This is mandatory if you use the Dumbella                                                                                                                                                                                 |
| **NETWORKING SETTINGS**                         |                                                                                                                                                                                                                                                                                                                                                                       |                                                                                                                                                                                                                           |
| appcomposer.ws.heart-beat.timeout               | NO: default value is 50                                                                                                                                                                                                                                                                                                                                               | NO: default value is 50000                                                                                                                                                                                                |
| **THREAD SETTINGS**                             |                                                                                                                                                                                                                                                                                                                                                                       |                                                                                                                                                                                                                           |
| appcomposer.task.execution.pool.core-size       |                                                                                                                                                                                                                                                                                                                                                                       | NO: default value is 50                                                                                                                                                                                                   |
| appcomposer.task.execution.pool.max-size        |                                                                                                                                                                                                                                                                                                                                                                       | NO: default value is 50                                                                                                                                                                                                   |
| appcomposer.task.session-content.delay          | Delay, in millisec, of the session content thread                                                                                                                                                                                                                                                                                                                     | Delay, in millisec, of the session content thread                                                                                                                                                                         |
| **WEB SOCKET SETTINGS**                         |                                                                                                                                                                                                                                                                                                                                                                       |                                                                                                                                                                                                                           |
| appcomposer.ws.reconnect.attempts               | Numbers of attempts to reconnect on a closing connection.                                                                                                                                                                                                                                                                                                             | NO: default value is 2                                                                                                                                                                                                    |
| appcomposer.ws.reconnect.stomp-attempts         | Numbers of attempts to reconnect using a brand new connection.                                                                                                                                                                                                                                                                                                        | NO: default value is 1                                                                                                                                                                                                    |
| appcomposer.ws.reconnect.delay                  | Delay, in millisec, between attempts of reconnecting.                                                                                                                                                                                                                                                                                                                 | NO: default value is 2000                                                                                                                                                                                                 |
| appcomposer.ws.heart-beat.client                | STOMP heart-beat, in millisec                                                                                                                                                                                                                                                                                                                                         | NO: default value is 20000                                                                                                                                                                                                |
| appcomposer.ws.heart-beat.server                | STOMP heart-beat, in millisec                                                                                                                                                                                                                                                                                                                                         | NO: default value is 20000                                                                                                                                                                                                |
| appcomposer.ws.heart-beat.master.client         | STOMP heart-beat, in millisec of the main ws connection.                                                                                                                                                                                                                                                                                                              | NO: default value is 20000                                                                                                                                                                                                |
| appcomposer.ws.heart-beat.master.server         | STOMP heart-beat, in millisec of the main ws connection.                                                                                                                                                                                                                                                                                                              | NO: default value is 2000                                                                                                                                                                                                 |
| appcomposer.ws.ping-pong.timeout                | Applicative ping/pong timing, in millisec.                                                                                                                                                                                                                                                                                                                            | NO: default value is 25000                                                                                                                                                                                                |
| appcomposer.ws.session-max-idle.timeout         | Web Socket connection idle timeout, in millisec.                                                                                                                                                                                                                                                                                                                      | NO: default value is 1800000 (30 min, should be equal to the http session timeout)                                                                                                                                        |
| **CONTENT SECURITY POLICY**                     | <p>Reference: <a href="https://content-security-policy.com/"><img src="https://content-security-policy.com/favicon.ico" alt="">Content-Security-Policy Header ⟶ CSP Reference &#x26; Examples</a></p><p><strong>Warning</strong>: if you need to set your CSP, you must change the directives adding clauses to the default values, without removing any of them.</p> |                                                                                                                                                                                                                           |
| appcomposer.security.csp.script-src             | CSP's script-src directive                                                                                                                                                                                                                                                                                                                                            | NO: default value is 'unsafe-inline' 'unsafe-eval' 'self' ;                                                                                                                                                               |
| appcomposer.security.csp.img-src                | CSP's img-src directive                                                                                                                                                                                                                                                                                                                                               | NO, default value is: _data:_ [_https://\*.openstreetmap.org_](https://decisyon.atlassian.net/wiki/spaces/~436823021/pages/2331115521/Changes+and+migration+of+version+2021.3.0) _'unsafe-inline' 'unsafe-eval' 'self' ;_ |
| appcomposer.security.csp.font-src               | CSP's font-src directive                                                                                                                                                                                                                                                                                                                                              | NO, default value is: _data:_ [_https://fonts.gstatic.com/_](https://fonts.gstatic.com/) _'unsafe-inline' 'unsafe-eval' 'self' ;_                                                                                         |
| appcomposer.security.csp.style-src              | CSP's style-src directive                                                                                                                                                                                                                                                                                                                                             | NO, default value is: _https://fonts.googleapis.com/ https://maxcdn.bootstrapcdn.com https://getbootstrap.com/ 'self' 'unsafe-inline' ;"_                                                                                 |
| appcomposer.security.csp.default-src            | CSP's default-src directive                                                                                                                                                                                                                                                                                                                                           | NO, default value is: _'self' ;_                                                                                                                                                                                          |
| appcomposer.security.csp.scr-src                | CSP's worker-src directive                                                                                                                                                                                                                                                                                                                                            | NO, default value is: _blob: ;_                                                                                                                                                                                           |
| appcomposer.security.csp.script-src             | CSP's form-action directive                                                                                                                                                                                                                                                                                                                                           | NO, default value is: _'self' ;_                                                                                                                                                                                          |

{% hint style="warning" %}
**Content Security Policy.**&#x20;

Using the **Content Security Policy** can prevent loading of external images or other resources, which are not hosted on DAC instances.&#x20;

Therefore some external resources may no longer be loaded due to security restrictions due to the Content Security Policy. See the **CONTENT SECURITY POLICY**  section of the previous table.
{% endhint %}

{% hint style="warning" %}
**Creation and management of a service DAC token for Dumbella service**

In order to communicate with the DAC, Dumbella service must have a token with which they can be recognized and authorized by the DAC. During the installation phase you will be asked to provide a seed with which the service will generate this token and will then be able to interact with the DAC under security.

**Please see the** [**Dumbella Installation guide**](../../../installation-guides/dumbella-installation-guide.md)
{% endhint %}

## Known issues <a href="#known-issues" id="known-issues"></a>

#### 1. Autocomplete on username and password on user creation dialog <a href="#autocomplete-on-username-and-password-on-user-creation-dialog" id="autocomplete-on-username-and-password-on-user-creation-dialog"></a>

In the user creation dialog, Chrome autocompile the username and password of the new user using the credentials that the logged used has, but it doesn't make sense.

**How To Fix?**

This feature must be disabled from the Chrome browser.



**2.Sql report**

System shows error message if new sql report is saved without a previous execution.

**How To Fix?**

**E**xecute the report before saving it.



## Removal Features <a href="#removal-features" id="removal-features"></a>

**This section of the Change Log provides a list of removed features.**

***

The following properties in **Tool** >> **Preferences** >> **Web** of the Design Studio are removed:

**Landing Page**

* **showSocialSpacesLink:**&#x65;nables the display of the social spaces in the DAC homepage (default).Session

**Session**

The following properties affecting the user session on DAC can be customized:

* **webSessionExpireTimeout(min)**

‌If a user does not properly log out of the system, (e.g. if the user is disconnected from the network or the browser crashes), the system forces user disconnection from DAC after the period set (in minutes) in this property (by default, 5 min.). This time is different from a time-out, which is due to user inactivity, and is defined in the DAC web.xml configuration file.

* ‌**showWebClosureConfirm**

‌If you close the browser, this property enables/disables a confirmation message (enabled by default).

***

**BRM/Drools**

Any code or reference to BRM / Drools has been removed from the DAC

## Others

### Refactoring and Simplification of Timezone settings <a href="#refactoring-and-simplification-of-timezone-settings" id="refactoring-and-simplification-of-timezone-settings"></a>

It is necessary to modify the calls to the user creation and modification api using the new format for the time zones (Europe/Rome, Europe/Paris ....) without any additional information.

* if set → use as timezone the leader of the timezone group.
* if not set → try to use Workspace' default timezone (if set and not auto) otherwise use Application Server and localisation set to true;

### Metric format <a href="#metric-format" id="metric-format"></a>

Three new priorities have been added in the Layer group of Graph:

* _**decimal-separator :**_ decimal separator applied to all chart series
* _**thousand-separator:**_ thousand separator applied to all chart series
* **additional-chars:** Additional chars applied to all chart series

During the migration the default values ​​will be those of the English notation:

* decimal-separator = ( **.** Point )
* thousand-separator = ( **,** Comma )

If you wish to use a notation other than the default (English) you can proceed as follows:

1. **Action:**\
   Manually change format chart by chart the value in the new property
2. **Action:**\
   Select the _Format-as-local_ property (Application >> Properties >> Metrics) and automatically the format used will depend on the language selected by the user.

### Refactoring of the DT Dialog <a href="#refactoring-of-the-dt-dialog" id="refactoring-of-the-dt-dialog"></a>

The DT Dialog created in previous version may now have a vertical scrollbar, depending on how they are designed.This is due to the higher height of the green bar in respect of the old dialog.

![](<../../../.gitbook/assets/image (24).png>)

_**How To Fix?**_

Identify all the DT dialog in your application and increase the height of the DT dialog.

### &#x20;SQL Parser <a href="#sql-parser" id="sql-parser"></a>

Starting from 2021.2.2, DAC uses a new SQL parser to analyse the queries.

Due to the fact that the grammar used by the parser and the one used by a RDBMS may differ, you might have report working with previous version no longer working with version > 2021.2.2.

Furthermore, the process of replacing the existing parsing mechanism with the new parser is no completed yet (you might have some formulas validated for defining a filter, but that cause the execution of the report fails), so it is **strongly recommended** to check that all the reports keep on working after upgrading to 2021.2.2.

Anyway, the differences you may find are trivial: in many cases it’d be sufficient to group expression in a better way using brackets, for example:

having

_CASE exp1 THEN exp2 ELSE exp3 OR value4 END;_

has to fix as following:

_CASE exp1 THEN exp2 ELSE (exp3 OR value4) END;_

&#x20;

### &#x20;<a href="#known-issues" id="known-issues"></a>
